CREATE TABLE abstract_word (id BIGINT AUTO_INCREMENT, name VARCHAR(100), name_stressed VARCHAR(100), name_broken VARCHAR(120), name_condensed VARCHAR(80), INDEX condensed_idx (name_condensed), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE derivative_form (id BIGINT AUTO_INCREMENT, name VARCHAR(100), name_stressed VARCHAR(100), name_broken VARCHAR(120), name_condensed VARCHAR(80), description VARCHAR(150), is_infinitive TINYINT(1) DEFAULT '0', base_word_id MEDIUMINT, search_count BIGINT DEFAULT 0, INDEX condensed_idx (name_condensed), INDEX name_idx (name), INDEX search_idx (search_count), INDEX base_word_id_idx (base_word_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE incorrect_form (id BIGINT AUTO_INCREMENT, name VARCHAR(100), correct_word_id MEDIUMINT, search_count BIGINT DEFAULT 0, deleted_at DATETIME, INDEX name_idx (name), INDEX name_correct_idx (name, correct_word_id), INDEX search_idx (search_count), INDEX correct_word_id_idx (correct_word_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE incorrect_form_revision (id BIGINT AUTO_INCREMENT, field VARCHAR(20), old_value LONGTEXT, new_value LONGTEXT, user_id INT, is_pattrolled TINYINT(1) DEFAULT '0', object_id BIGINT, created_at DATETIME NOT NULL, INDEX field_idx (field), INDEX is_pattrolled_idx (is_pattrolled), INDEX user_id_idx (user_id), INDEX object_id_idx (object_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE revision (id BIGINT AUTO_INCREMENT, field VARCHAR(20), old_value LONGTEXT, new_value LONGTEXT, user_id INT, is_pattrolled TINYINT(1) DEFAULT '0', created_at DATETIME NOT NULL, INDEX field_idx (field), INDEX is_pattrolled_idx (is_pattrolled), INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE word (name VARCHAR(100), name_stressed VARCHAR(100), name_broken VARCHAR(120), name_condensed VARCHAR(80), id MEDIUMINT AUTO_INCREMENT, meaning LONGTEXT, synonyms LONGTEXT, classification TEXT, type_id SMALLINT, pronounciation VARCHAR(100), etymology LONGTEXT, related_words LONGTEXT, derived_words LONGTEXT, chitanka_count BIGINT, chitanka_percent FLOAT(18, 2), chitanka_rank MEDIUMINT, search_count BIGINT DEFAULT 0, source ENUM('bgoffice', 'eurodict', 'idi', 'onlinerechnik', 'user') DEFAULT 'user', other_langs TEXT, deleted_at DATETIME, INDEX condensed_idx (name_condensed), UNIQUE INDEX name_type_idx (name, type_id), INDEX search_idx (search_count), INDEX type_id_idx (type_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE word_revision (id BIGINT AUTO_INCREMENT, field VARCHAR(20), old_value LONGTEXT, new_value LONGTEXT, user_id INT, is_pattrolled TINYINT(1) DEFAULT '0', object_id MEDIUMINT, created_at DATETIME NOT NULL, INDEX field_idx (field), INDEX is_pattrolled_idx (is_pattrolled), INDEX user_id_idx (user_id), INDEX object_id_idx (object_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE word_translation (id BIGINT AUTO_INCREMENT, word_id MEDIUMINT, lang VARCHAR(3), content LONGTEXT, source ENUM('eurodict', 'user') DEFAULT 'user', UNIQUE INDEX word_lang_idx (word_id, lang), INDEX word_id_idx (word_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE word_type (id SMALLINT AUTO_INCREMENT, name VARCHAR(10), idi_number SMALLINT UNSIGNED, speech_part VARCHAR(60), comment LONGTEXT, rules LONGTEXT, rules_test LONGTEXT, example_word VARCHAR(100), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group (id INT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id INT, permission_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id INT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id INT AUTO_INCREMENT, user_id INT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id, ip_address)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user (id INT AUTO_INCREMENT, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id INT, group_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id INT, permission_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_profile (id BIGINT AUTO_INCREMENT, user_id INT, realname VARCHAR(60), email VARCHAR(60), INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
ALTER TABLE derivative_form ADD CONSTRAINT derivative_form_base_word_id_word_id FOREIGN KEY (base_word_id) REFERENCES word(id) ON DELETE CASCADE;
ALTER TABLE incorrect_form ADD CONSTRAINT incorrect_form_correct_word_id_word_id FOREIGN KEY (correct_word_id) REFERENCES word(id) ON DELETE CASCADE;
ALTER TABLE incorrect_form_revision ADD CONSTRAINT incorrect_form_revision_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE incorrect_form_revision ADD CONSTRAINT incorrect_form_revision_object_id_incorrect_form_id FOREIGN KEY (object_id) REFERENCES incorrect_form(id);
ALTER TABLE revision ADD CONSTRAINT revision_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE word ADD CONSTRAINT word_type_id_word_type_id FOREIGN KEY (type_id) REFERENCES word_type(id);
ALTER TABLE word_revision ADD CONSTRAINT word_revision_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE word_revision ADD CONSTRAINT word_revision_object_id_word_id FOREIGN KEY (object_id) REFERENCES word(id);
ALTER TABLE word_translation ADD CONSTRAINT word_translation_word_id_word_id FOREIGN KEY (word_id) REFERENCES word(id);
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_profile ADD CONSTRAINT sf_guard_user_profile_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
